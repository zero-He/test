define(function (require, exports, module) {
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function sortByField(t,e,r){t.sort(function(t,n){t=t[e],n=n[e];var o=r?1:-1;return t>n?o:t<n?-o:0})}function convertColumns(t){return t.map(function(t){var e={title:t.title,field:t.field,width:t.width,render:function(e,r){var n=t.field,o=t.render,a=t.fmt,l=e[n];if(o&&"function"==typeof o&&(l=o(l,e,r)),void 0===l||null===l||""===l)return"";if(a&&"string"==typeof a){var c=a.match(/(\w+)`(.*)`/);"date"===c[1]?l=LekeDate.of(l).format(c[2]):"number"==c[1]&&(l=Utils.Number.format(l,c[2]))}return l}};return t.onSort&&(e.sort=SORT_DEF,e.onSort=function(e,r){!0===t.onSort?sortByField(e,t.field,r):"function"==typeof t.onSort?t.onSort(e,r):sortByField(e,t.onSort,r)}),e})}var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),React=require("common/react/react"),SORT_ASC="m-sort-asc",SORT_DESC="m-sort-desc",SORT_DEF="m-sort-default",DataGrid=function(t){function e(t){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.handleOnSort=function(t){var e=r.state,n=e.columns,o=e.datas;n.forEach(function(e,r){e.sort&&r!=t&&(e.sort=SORT_DEF)});var a=n[t];a.sort==SORT_ASC?a.sort=SORT_DESC:a.sort=SORT_ASC,a.onSort(o,a.sort===SORT_ASC),r.setState({columns:n,datas:o,sortCol:a})},r.state={columns:convertColumns(t.columns),datas:t.datas,total:t.total,sortCol:null},r}return _inherits(e,t),_createClass(e,[{key:"componentWillReceiveProps",value:function(t){var e=t.datas,r=t.total,n=this.state.sortCol;n&&n.onSort(e,n.sort===SORT_ASC),this.setState({datas:e,total:r})}},{key:"render",value:function(){var t=this,e=this.state,r=e.columns,n=e.datas,o=e.total,a=r.map(function(e,r){var n={};return e.width&&(n.width=e.width),e.sort?React.createElement("th",{key:r,style:n,className:"m-sort-leke",onClick:function(){return t.handleOnSort(r)}},e.title,React.createElement("i",{className:e.sort})):React.createElement("th",{key:r,style:n},e.title)});o&&(n=n.concat(o));var l=n.map(function(t,e){var n=r.map(function(r,n){var o={};r.width&&(o.width=r.width);r.render(t,e);return React.createElement("td",{key:n,style:o},r.render(t,e))});return React.createElement("tr",{key:e},n)});return React.createElement("div",{className:"m-table m-table-center"},React.createElement("table",null,React.createElement("thead",null,React.createElement("tr",null,a)),React.createElement("tbody",null,l)))}}]),e}(React.Component);module.exports=DataGrid;
});