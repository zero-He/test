define(function (require, exports, module) {
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function renderLekeVal(e,t,a){return(e[t]?e[t]:0)+(e[a]?e[a]:0)}function colored(e){return React.createElement("span",{className:"colored"},e)}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}(),React=require("common/react/react"),ReactDOM=require("common/react/react-dom"),$=require("jquery"),_require=require("common/react/react-utils"),cx=_require.cx,ReactChart=require("common/react/ReactChart"),BehaviorChartConfig=require("./BehaviorChartConfig"),_require2=require("./helper"),toFixed=_require2.toFixed,toRate=_require2.toRate,Dialog=require("dialog"),ScoreReportQuery=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={typeIdx:0,zoneIdx:0,cycleId:e.types[0].list[0].id},a.handleChangeCycle=a.handleChangeCycle.bind(a),a.handleChangeZone=a.handleChangeZone.bind(a),a}return _inherits(t,e),_createClass(t,[{key:"handleClickType",value:function(e){if(this.state.typeIdx!=e){var t=this.props.types[e].list[0].id;this.setState({typeIdx:e,cycleId:t}),this.handleChange(this.state.zoneIdx,t)}}},{key:"handleChangeCycle",value:function(e){var t=parseInt(e.target.value);this.setState({cycleId:t}),this.handleChange(this.state.zoneIdx,t)}},{key:"handleChangeZone",value:function(e){var t=parseInt(e.target.value);this.setState({zoneIdx:t}),this.handleChange(t,this.state.cycleId)}},{key:"handleChange",value:function(e,t){if(this.props.onChange){var a=this.props.zones[e];this.props.onChange(a.classId,a.subjectId,t)}}},{key:"componentDidMount",value:function(){var e=this.state,t=e.zoneIdx,a=e.cycleId;this.handleChange(t,a)}},{key:"render",value:function(){var e=this,t=this.state,a=t.typeIdx,l=t.cycleId,n=this.props,c=n.types,r=n.zones,s=n.hideZone;return React.createElement("div",{className:"m-search-box"},React.createElement("div",{className:"f-fl"},React.createElement("ul",null,c.map(function(t,l){var n=e.handleClickType.bind(e,l);return React.createElement("li",{key:l,className:cx({active:l==a})},React.createElement("a",{onClick:n},t.label))}))),React.createElement("div",{className:"f-fr"},React.createElement("select",{className:"u-select u-select-lg",onChange:this.handleChangeCycle},c[a].list.map(function(e,t){return React.createElement("option",{key:t,value:e.id,selected:e.id==l},e.label)})),React.createElement("select",{className:cx("u-select u-select-lg",{"f-dn":s||!1}),onChange:this.handleChangeZone},r.map(function(e,t){return React.createElement("option",{key:t,value:t},e.label)}))))}}]),t}(React.Component),PersonSummary=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.userName,a=e.achieve,l=a.totalNum,n=a.attendRate,c=a.previewRate,r=a.reviewRate,s=a.submitRate,i=a.bugFixRate,o=a.achieveNum,m=a.lekeNum;return React.createElement("div",{className:"summary"},React.createElement("p",null,"亲爱的",React.createElement("span",{className:"colored"},t),"同学："),React.createElement("p",{className:"details"},"在此期间内，您应上课堂",colored(l),"节，出勤率",colored(n+"%"),"； 预/复习比率分别为",colored(c+"%"),"，",colored(r+"%"),"； 作业提交率",colored(s+"%"),"，订正率",colored(i+"%"),"； 共取得",colored(o),"项成就，获得乐豆",colored(m),"； 请努力学习，有付出就有收获。"))}}]),t}(React.Component),Achieves=[["isAttend","allthework","全勤"],["isPreview","preview","提前预习"],["isListen","listen","专心听讲"],["isLoveAck","hardworking","勤思好问"],["isActive","active","活跃分子"],["isRanking","succeed","榜上有名"],["isFragrant","help f-ml50 f-pl50","手有余香"],["isReform","earnest","及时改错"],["isDiligent","positive","不磨蹭"],["isPractice","intelligent","练习达人"],["isRefresh","study","温故知新"]],AchievementInfo=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"handleHelp",value:function(){Dialog.open({title:"帮助",url:Leke.domain.staticServerName+"/pages/help-center/achievement.html"})}},{key:"render",value:function(){var e=this.props.achieve;return React.createElement("div",null,React.createElement("p",{className:"tittle"},React.createElement("span",null,"成就"),React.createElement("span",{className:"achievementtips"},React.createElement("i",null,"*")," 点亮表示已获得此成就，灰色表示暂未获得此成就 "),React.createElement("i",{className:"help",onClick:this.handleHelp})),React.createElement("div",{className:"achievement"},React.createElement("ul",null,Achieves.map(function(t){return React.createElement("li",{className:t[1]+(e[t[0]]?"":" lighten")},React.createElement("i",null),t[2])}))))}}]),t}(React.Component),ClassStuationInfo=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props.attendStatInfo,t=this.props.behaviorInfo,a=this.props.lekeVal,l=[{name:"全勤",value:e.realNum-e.partNum},{name:"非全勤",value:e.partNum},{name:"缺勤",value:e.missNum}];return React.createElement("div",{className:"classsituation"},React.createElement("p",{className:"tittle"},"上课情况"),React.createElement("div",{className:"reportform"},React.createElement("div",{className:"checkingin"},React.createElement("h3",{className:"title f-tac"},"考勤情况 ","hd"==Leke.device?null:React.createElement("i",{className:"help",title:"在线时长T>=80%,本堂课计为全勤，T<80%,计为非全勤，从未上线，计为缺勤。"})),React.createElement(ReactChart,{style:{width:360,height:360},option:BehaviorChartConfig.buildGeneralPie("应上课堂："+e.planNum,l)}),React.createElement("p",null,React.createElement("span",null,"应上课堂",React.createElement("span",{className:"colored"},e.planNum),"节，"),React.createElement("span",null,"全勤",React.createElement("span",{className:"colored"},e.realNum-e.partNum),"次，"),React.createElement("span",null,"非全勤",React.createElement("span",{className:"pointed"},e.partNum),"次，"),React.createElement("span",null,"缺勤",React.createElement("span",{className:"pointed"},e.missNum),"次，"),React.createElement("span",null,"全勤率",React.createElement("span",{className:"colored"},toRate(e.realNum-e.partNum,e.planNum),"%"))))),React.createElement("div",{className:"reportform"},React.createElement("div",{className:"classroom"},React.createElement("p",{className:"title f-tac f-pr"},"课堂行为 ",React.createElement("a",{href:"inclass.htm?cycleId="+this.props.cycleId,target:"_blank",className:"detailslable"},"详情",React.createElement("i",null))),React.createElement("div",{className:"m-table m-table-center"},React.createElement("table",null,React.createElement("tbody",null,React.createElement("tr",null,React.createElement("th",null,"项目"),React.createElement("th",null,"数量"),React.createElement("th",null,"获得乐币")),React.createElement("tr",null,React.createElement("td",null,"金榜题名"),React.createElement("td",null,t.rank1,"/",t.rank2,"/",t.rank3," ","hd"==Leke.device?null:React.createElement("i",{className:"help f-csp",title:"”a/b/c“分别代表获得状元、榜眼、探花的课堂数"})),React.createElement("td",null,renderLekeVal(a,"12302"))),React.createElement("tr",null,React.createElement("td",null,"点到"),React.createElement("td",null,t.callNum1,"/",t.callNum2),React.createElement("td",null,renderLekeVal(a,"12306"))),React.createElement("tr",null,React.createElement("td",null,"举手"),React.createElement("td",null,t.raised),React.createElement("td",null,renderLekeVal(a,"12103"))),React.createElement("tr",null,React.createElement("td",null,"被授权"),React.createElement("td",null,t.authed),React.createElement("td",null,"--")),React.createElement("tr",null,React.createElement("td",null,"课堂笔记"),React.createElement("td",null,t.noteNum),React.createElement("td",null,renderLekeVal(a,"12105"))),React.createElement("tr",null,React.createElement("td",null,"随堂作业"),React.createElement("td",null,t.examNum1,"/",t.examNum2),React.createElement("td",null,"--")),React.createElement("tr",null,React.createElement("td",null,"快速问答"),React.createElement("td",null,t.quickNum1,"/",t.quickNum2),React.createElement("td",null,"--")),React.createElement("tr",null,React.createElement("td",null,"分组讨论"),React.createElement("td",null,t.discuNum1,"/",t.discuNum2),React.createElement("td",null,renderLekeVal(a,"12307","12308"))),React.createElement("tr",null,React.createElement("td",null,"献花"),React.createElement("td",null,t.flowerNum),React.createElement("td",null,renderLekeVal(a,"12107"))),React.createElement("tr",null,React.createElement("td",null,"评价"),React.createElement("td",null,t.evalNum,"/",e.realNum),React.createElement("td",null,renderLekeVal(a,"12104")))))))))}}]),t}(React.Component),ViewFinishAnalyInfo=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props.viewFinishAnaly,t=[{name:"课件",max:e.totalNum},{name:"微课",max:e.totalNum},{name:"作业",max:e.totalNum}],a=[{name:"作业",max:e.totalNum},{name:"订正作业",max:e.totalNum},{name:"查看笔记",max:e.totalNum}],l=[{name:"应预习",value:e.previews1},{name:"实预习",value:e.previews2}],n=[{name:"应复习",value:e.reviews1},{name:"实复习",value:e.reviews2}];return React.createElement("div",{className:"classsituation"},React.createElement("p",{className:"tittle"},"预复习情况"),React.createElement("div",{className:"reportform f-pr"},React.createElement(ReactChart,{style:{height:360},option:BehaviorChartConfig.buildGeneralRadar(t,l)})),React.createElement("div",{className:"reportform"},React.createElement(ReactChart,{style:{height:360},option:BehaviorChartConfig.buildGeneralRadar(a,n)})),React.createElement("div",{className:"m-table m-table-center f-cb"},React.createElement("table",null,React.createElement("tbody",null,React.createElement("tr",null,React.createElement("th",null,"总课堂数"),React.createElement("th",null,"可预习课堂数"),React.createElement("th",null,"实预习(比率)"),React.createElement("th",null,"可复习课堂数"),React.createElement("th",null,"实复习(比率)")),React.createElement("tr",null,React.createElement("td",null,e.totalNum),React.createElement("td",null,e.preview1),React.createElement("td",null,e.preview2,"（",toRate(e.preview2,e.preview1),"%）"),React.createElement("td",null,e.review1),React.createElement("td",null,e.review2,"（",toRate(e.review2,e.review1),"%）"))))))}}]),t}(React.Component),WorkFinishAnalyInfo=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props.workFinishAnaly,t=e.totalNum,a=e.normalNum,l=e.delayNum,n=e.doneBugFixNum,c=e.undoBugFixNum,r=t-a-l,s=n+c,i="应交作业："+t,o=[{name:"正常提交",value:a},{name:"延迟提交",value:l},{name:"未提交",value:r}],m="应订正作业："+s,u=[{name:"已订正",value:n},{name:"未订正",value:c}];return React.createElement("div",{className:"classsituation"},React.createElement("p",{className:"tittle"},"作业情况"),React.createElement("div",{className:"reportform"},React.createElement("h3",{className:"title f-tac f-pr"},"完成情况 ",React.createElement("a",{href:"homework.htm?cycleId="+this.props.cycleId,target:"_blank",className:"detailslable"},"详情",React.createElement("i",null))),React.createElement("div",{className:"f-pr"},React.createElement(ReactChart,{style:{height:360},option:BehaviorChartConfig.buildGeneralPie(i,o)}))),React.createElement("div",{className:"reportform"},React.createElement("p",{className:"title f-tac"},"订正情况"),React.createElement("div",{className:"f-pr"},React.createElement(ReactChart,{style:{height:360},option:BehaviorChartConfig.buildGeneralPie(m,u)}))))}}]),t}(React.Component),OtherBehaviorInfo=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props.lekeVal,t=this.props.otherWiseInfo,a=t.practiceNum,l=t.killWrongNum,n=t.writeNoteNum,c=t.doubtNum;return React.createElement("div",null,React.createElement("p",{className:"tittle"},"其它学习行为汇总"),React.createElement("div",{className:"m-table m-table-center"},React.createElement("table",null,React.createElement("tbody",null,React.createElement("tr",null,React.createElement("th",null,"项目"),React.createElement("th",null,"自主练习"),React.createElement("th",null,"消灭错题"),React.createElement("th",null,"课外笔记"),React.createElement("th",null,"提问")),React.createElement("tr",null,React.createElement("td",null,"数目"),React.createElement("td",null,a,"题"),React.createElement("td",null,l,"题"),React.createElement("td",null,n,"份"),React.createElement("td",null,c,"次")),React.createElement("tr",null,React.createElement("td",null,"获得乐豆"),React.createElement("td",null,renderLekeVal(e,"11301")),React.createElement("td",null,renderLekeVal(e,"11304")),React.createElement("td",null,"--"),React.createElement("td",null,renderLekeVal(e,"11302")))))))}}]),t}(React.Component),PersonBehavior=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={loading:!1,cycleId:null,view:null},a.handleChangeQuery=a.handleChangeQuery.bind(a),a}return _inherits(t,e),_createClass(t,[{key:"handleChangeQuery",value:function(e,t,a){this.setState({loading:!0}),$.post("index2.htm",{classId:e,subjectId:t,cycleId:a}).done(function(e){this.setState({loading:!1,cycleId:a,view:e.datas.view})}.bind(this))}},{key:"renderBody",value:function(){var e=this.state,t=e.cycleId,a=e.loading,l=e.view;return null==l||1==a?React.createElement("div",{className:"m-mask"},React.createElement("div",{className:"con"},React.createElement("i",null),React.createElement("div",null,"数据加载中"))):0==l.success?React.createElement("div",{className:"m-tips"},React.createElement("i",null),React.createElement("span",null,l.message)):React.createElement("div",{className:"c-syn-subj"},React.createElement(PersonSummary,{achieve:l.achieveInfo,userName:ReportCst.userName}),React.createElement(AchievementInfo,{achieve:l.achieveInfo,lekeVal:l.lekeVal}),React.createElement(ClassStuationInfo,{behaviorInfo:l.behaviorInfo,attendStatInfo:l.attendStatInfo,lekeVal:l.lekeVal,cycleId:t}),React.createElement(ViewFinishAnalyInfo,{viewFinishAnaly:l.viewFinishAnaly}),React.createElement(WorkFinishAnalyInfo,{workFinishAnaly:l.workFinishAnaly,cycleId:t}),React.createElement(OtherBehaviorInfo,{otherWiseInfo:l.otherWiseInfo,lekeVal:l.lekeVal}))}},{key:"render",value:function(){var e=ReportCst,t=e.types,a=e.zones;e.mode,e.view,e.userName;return React.createElement("div",{className:"analysis"},React.createElement(ScoreReportQuery,{types:t,zones:a,hideZone:!0,onChange:this.handleChangeQuery}),this.renderBody())}}]),t}(React.Component),conatiner=document.getElementById("container");ReactDOM.render(React.createElement(PersonBehavior,null),container);
});