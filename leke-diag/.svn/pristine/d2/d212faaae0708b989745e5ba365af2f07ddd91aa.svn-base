define(function (require, exports, module) {
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function parseQuery(e,t){var n={cycleId:e.value};return t.forEach(function(e){n[e.field]=e.value}),n}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),React=require("common/react/react"),AnalyseFilter=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChangeQuery=function(e,t){n.query[e]=t,n.doQuery()},n.doQuery=function(){var e=n.props.onFilterQuery;if(e){var t=n.query;if(t.klassId){var r=t.klassId.match(/(\d+)-(\d+)/);3==r.length&&(t.classId=r[1],t.subjectId=r[2])}e(t)}},n.state={typeIdx:0},n.query=parseQuery(e.cycle,e.options),n}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.doQuery()}},{key:"render",value:function(){var e=this,t=this.state.typeIdx,n=this.props,r=n.cycle,a=n.options;return React.createElement("div",{className:"m-search-box"},React.createElement("div",{className:"f-fl"},React.createElement("ul",null,r.items.map(function(n,r){var a=function(){e.setState({typeIdx:r}),e.handleChangeQuery("cycleId",n.subs[0].value)};return React.createElement("li",{key:r,className:r==t?"active":""},React.createElement("a",{onClick:a},n.label))}))),React.createElement("div",{className:"f-fr"},React.createElement(Select,{key:"cycleId",field:"cycleId",items:r.items[t].subs,onChange:e.handleChangeQuery}),a.map(function(t){return React.createElement(Select,{key:t.field,field:t.field,items:t.items,onChange:e.handleChangeQuery})})))}}]),t}(React.Component),Select=function(e){function t(){var e,n,r,a;_classCallCheck(this,t);for(var l=arguments.length,c=Array(l),o=0;o<l;o++)c[o]=arguments[o];return n=r=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.handleChange=function(e){var t=r.props,n=t.field,a=t.onChange;a&&a(n,e.target.value)},a=n,_possibleConstructorReturn(r,a)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=this.props.items;return React.createElement("select",{className:"u-select u-select-lg",onChange:this.handleChange},e.map(function(e){return React.createElement("option",{key:e.value,value:e.value},e.label)}))}}]),t}(React.Component);AnalyseFilter.buildOption=function(e,t,n){var r=n[0],a=!1;return r&&r.subs&&r.subs.length&&(r=r.subs[0],a=!0),{title:e,field:t,value:r?r.value:null,hasGroup:a,items:n}},module.exports=AnalyseFilter;
});