define(function (require, exports, module) {
"use strict";function sortByField(t,r,n){t.sort(function(t,i){t=t[r],i=i[r];var o=n?1:-1;return t>i?o:t<i?-o:0})}function convertColumns(t){return t.map(function(t){var r={title:t.title,field:t.field,width:t.width,render:function(r,n){var i=t.field,o=t.render,e=t.fmt,s=r[i];if(o&&$.isFunction(o)&&(s=o(s,r,n)),void 0===s||null===s||""===s)return"";if(e&&"string"==typeof e){var a=e.match(/(\w+)`(.*)`/);"date"===a[1]?s=LekeDate.of(s).format(a[2]):"number"==a[1]&&(s=Utils.Number.format(s,a[2]))}return s}};return t.onSort&&(r.sort=SORT_DEF,r.onSort=function(r,n){!0===t.onSort?sortByField(r,t.field,n):$.isFunction(t.onSort)?t.onSort(r,n):sortByField(r,t.onSort,n)}),r})}var $=require("jquery"),Utils=require("utils"),LekeDate=require("/common/base/date"),SORT_ASC="m-sort-asc",SORT_DESC="m-sort-desc",SORT_DEF="m-sort-default",StaticDataGrid=function(t,r){this.$el=$(t),this.opts=r,this.datas=r.datas,this.columns=convertColumns(r.columns),this.render()};StaticDataGrid.prototype.render=function(){var t=this,r=this.datas,n=this.columns,i=n.map(function(t,r){var n=t.width?'style="width: '+t.width+'"':"",i=t.sort?'class="m-sort-leke"':"",o=t.sort?'<i class="'+t.sort+'"></i>':"";return'<th data-colidx="'+r+'" '+n+" "+i+">"+t.title+o+"</th>"}).join(""),o=r.map(function(t,r){return"<tr>"+n.map(function(n){n.width&&n.width;return"<td>"+n.render(t,r)+"</td>"}).join("")+"</tr>"}).join(""),e="\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>"+i+"</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t"+o+"\n\t\t\t</tbody>\n\t\t</table>\n\t";0==r.length&&(e+='<div class="m-tips"><i></i><span>对不起，没有您要查询的数据</span></div>'),this.$el.html(e),this.$el.find("th.m-sort-leke").click(function(){var i=parseInt($(this).data("colidx"));n.forEach(function(t,r){t.sort&&r!=i&&(t.sort=SORT_DEF)});var o=n[i];o.sort==SORT_ASC?o.sort=SORT_DESC:o.sort=SORT_ASC,o.onSort(r,o.sort===SORT_ASC),t.render()})},module.exports=StaticDataGrid;
});